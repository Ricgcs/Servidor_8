<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../img/logo_inteiro.png">
    <link rel="stylesheet" href="../estilo/equipe.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <title id="titulo"></title>
</head>
<body>
<header id="cabecalho">
    <h1 id="header_inovaworks">InovaWorks</h1>

    <div id="header_links">
        <a href="./inicial_login.html"><img id="imagem" src="../img/home.png" alt="menu"><button id="header_button">Home</button></a>
        <a href="./index.html"><img id="imagem" src="../img/servicos.png" alt="servicos"><button id="header_button">Serviços</button></a>
        <a href="./estoque.html"><img id="imagem" src="../img/armazen.png" alt="estoque"><button id="header_button">Estoque</button></a>
        <a href="#"><img id="imagem" src="../img/nsei.png" alt="ajuda"><button id="header_button">Ajuda</button></a>
        <a href="#"><img id="imagem" src="../img/flecha.png" alt="log_out"><button id="header_button" onclick="logOut()">Log out</button></a>
    </div>

    <div id="header_user">
        <img id="img_user" src="" alt="imagem_usuario">
        <div id="header_config">
            <h1 id="nome_user"></h1>
            <a id="link_user" href="./config.html">configuração</a>
        </div>
    </div>
</header>

<div id="corpo">

   <div id="barra_lateral">
    
    <button id="button_cargo" class="hover-bar">Cargos</button>
    <button id="button_funcionario" class="hover-bar">Funcionários</button>
    <button id="button_fornecedor" class="hover-bar">Fornecedors</button>
    <div class="custom-hr"></div>
   </div>

   <div id="conteudo">
    <div id="cabeca_connteudo">
        
        <div id="pesquisa">
            <input type="text" id="input_pesquisa_conteudo">
            <button id="pesquisa_lupa"><img src="../img/lupa.png" id="pesq"></button>
        </div>

    

    </div>

    <div id="corpo_conteudo">

    </div>
   </div>
</div>

<script>
function logOut() {  
    if (confirm("Tem certeza que deseja sair da conta?")) {
        localStorage.clear();
        window.location.href = '"../../inicial/front/inicial.html"';
    } 
}

document.addEventListener('DOMContentLoaded', () => {
    const nomeUser = localStorage.getItem('nome') || 'Usuário';
    const senhaUser = localStorage.getItem('senha');
    const codUser = localStorage.getItem('cnpj');
    const nome = localStorage.getItem("nome");
    if (!nomeUser || !senhaUser || !codUser) {
        alert("faça o login");
        window.location.href = "../../inicial/front/inicial.html";
    }
   
    const loadFromLocalStorage = () => {
        const nomeUserElement = document.getElementById('nome_user');
        if (nomeUserElement) {
            const primeiroNome = nomeUser.split(" ")[0];
            nomeUserElement.textContent = `${primeiroNome}`; 
        }

        const imgUserElement = document.getElementById('img_user');
        async function loadImage() {
            try {
                const response = await fetch(`http://localhost:3000/empresa/imagem/${nomeUser}`);
                const blob = await response.blob();
                if (response.ok) {
                    imgUserElement.src = blob ? URL.createObjectURL(blob) : "../img/imagem_user.png";
                } else {
                    alert("erro médio");
                }
            } catch (error) {
                imgUserElement.src = "../img/imagem_user.png";
                console.error(error);
            }  
        }
        loadImage();
    };
    
    loadFromLocalStorage();


    const btn_cargo = document.getElementById('button_cargo');
    const btn_funcionario = document.getElementById('button_funcionario');
    const btn_fornecedor = document.getElementById('button_fornecedor');

    const input_cargo_nome = document.createElement("input");
    input_cargo_nome.id ="input_cargo_nome";
    input_cargo_nome.placeholder = "Nome do cargo";

    const input_cargo_salario = document.createElement("input");
    input_cargo_salario.id ="input_cargo_salario";
    input_cargo_salario.placeholder = "Quantidade salário";
    input_cargo_salario.type = "number";

    const button_cadastro= document.createElement("button");
    button_cadastro.id ="button_cadastro";
    button_cadastro.textContent = "Cadastrar";

    const button_visualizar = document.createElement("button");
    button_visualizar.id ="button_visualizar";
    button_visualizar.textContent = "Vizualizar";


    const div_header = document.createElement("div");
    div_header.id = "div_header";

    const texto_header = document.createElement("h1");
    texto_header.id = "texto_header";

    const texto_header_barra = document.createElement("hr");
    texto_header_barra.id = "texto_header_barra";


    const div0 = document.createElement("div");
    div0.id = "div0";

    const div1 = document.createElement("div");
    div1.id = "div1";

    const div2 = document.createElement("div");
    div2.id = "div2";

    const div3 = document.createElement("div");
    div3.id = "div3";


    
    const diva = document.createElement("div");
    diva.id = "diva";

    const divb = document.createElement("div");
    divb.id = "divb";

    const divc = document.createElement("div");
    divc.id = "divc";

    const divd = document.createElement("div");
    divd.id = "divd";

    const dive = document.createElement("div");
    dive.id = "dive";

    

    const input1 = document.createElement('input');
    input1.id = "input1";
    input1.type = 'checkbox';

    const input2 = document.createElement('input');
    input2.id = "input2";
    input2.type = 'checkbox';

    const input3 = document.createElement('input');
    input3.id = "input3";
    input3.type = 'checkbox';

    const input4 = document.createElement('input');
    input4.id = "input4";
    input4.type = 'checkbox';

    const input5 = document.createElement('input');
    input5.id = "input5";
    input5.type = 'checkbox';

    const input6 = document.createElement('input');
    input6.id = "input6";
    input6.type = 'checkbox';

     const h11 =document.createElement("h1");
     h11.id = "h11";

    const h12 =document.createElement("h1");
     h12.id = "h12";

     const h13 =document.createElement("h1");
     h13.id = "h13";

     const h14 =document.createElement("h1");
     h14.id = "h14";

     const h15 =document.createElement("h1");
     h15.id = "h15";
    
 const cadastros = async ()=>{
    const tela = document.getElementById('corpo_conteudo');
    const div_cadastro = document.createElement('div');
    div_cadastro.id = "div_cadastro";


    btn_cargo.addEventListener('click',()=>{
     
        tela.innerHTML = "";     
        div_cadastro.innerHTML = "";   
        div_header.innerHTML ="";
        tela.appendChild(div_cadastro);
        div_cadastro.appendChild(div_header);
        div_header.appendChild(texto_header);
        texto_header.textContent ="Cadastro cargo";

        texto_header.appendChild(texto_header_barra);
        div_cadastro.appendChild(input_cargo_nome);
        div_cadastro.appendChild(input_cargo_salario);
        div_cadastro.appendChild(button_cadastro);
        div_cadastro.appendChild(button_visualizar);
        div_cadastro.appendChild(div0);

        div0.appendChild(div1);
        div1.appendChild(diva);
        div1.appendChild(divb);
        diva.appendChild(input1);
        diva.appendChild(h11);
        h11.textContent = "Estoque";
        
        divb.appendChild(input2);
        divb.appendChild(h12);
        h12.textContent = "Orçamento"

        div0.appendChild(div2);
        div2.appendChild(divc);
        div2.appendChild(divd);

        divc.appendChild(input3);
        divc.appendChild(h13);
        h13.textContent = "Serviços";

        divd.appendChild(input4);
        divd.appendChild(h14);
        h14.textContent = "Equipe";

        div0.appendChild(div3);
        div3.appendChild(dive)
        dive.appendChild(input5);
        dive.appendChild(h15);
        h15.textContent = "Fluxo de caixa";
        dive.appendChild(input6);

        button_cadastro.addEventListener("click", async ()=>{
            
            //Empresa_Cod_empresa, Nome, Salario, Equipe, fluxo_caixa, servicos, orcamentos, estoque
            try {
                const nome_cargo = document.getElementById("input_cargo_nome").value;
                const Salario = document.getElementById("input_cargo_salario").value;
                let Equipe = 0;
                let fluxo_caixa = 0;
                let servicos = 0;
                let orcamentos = 0;
                let estoque = 0;


                if(input1.checked){
                    
                         Equipe = 1;
                }

                if(input2.checked){
                        fluxo_caixa = 1;
                }
               
                if(input3.checked){
                        servicos = 1;
                }

                if(input4.checked){
                        orcamentos = 1;

                }

                if(input5.checked){
                        estoque = 1;
                }
             
                    const cod_um = await fetch(`http://localhost:3000/empresa/cod/${nomeUser}`);
                const cod_empr = Number(await cod_um.json());
console.log(cod_empr);


                    const response = await fetch(`http://localhost:3000/cargo/${cod_empr}/${nome_cargo}/${Salario}/${Equipe}/${fluxo_caixa}/${servicos}/${orcamentos}/${estoque}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });
                   
                    if (response.ok) {
                        
                        const result = await response.json();
                        alert(result.message); 
                    } else {
                        alert('Erro ao adicionar cargo');
                        console.log(response)
                    }

                } catch (error) {
                    console.error('Erro na requisição:', error);

                    alert('Erro do lado do servidor');
                }
            })     
       


            
    });


  
const div_nome = document.createElement("div");
div_nome.id = "div_nome";

const input_nome = document.createElement("input");
input_nome.id = "input_nome";

const h1_nome = document.createElement("h1");
h1_nome.id = "h1_nome";

const div_cargo = document.createElement("div");
div_cargo.id = "div_cargo";

const input_cargo = document.createElement("select");
input_cargo.id = "input_cargo";

const h1_cargo = document.createElement("h1");
h1_cargo.id = "h1_cargo";

const div_rg = document.createElement("div");
div_rg.id = "div_rg";

const input_rg = document.createElement("input");
input_rg.id = "input_rg";
input_rg.type = "number";
const h1_rg = document.createElement("h1");
h1_rg.id = "h1_rg";


const div_cpf = document.createElement("div");
div_cpf.id = "div_cpf";

const input_cpf = document.createElement("input");
input_cpf.id = "input_cpf";
input_cpf.type = "number";

const h1_cpf = document.createElement("h1");
h1_cpf.id = "h1_cpf";


const div_data = document.createElement("div");
div_data.id = "div_data";

const input_data = document.createElement("input");
input_data.id = "input_data";
input_data.type = "date";

const h1_data = document.createElement("h1");
h1_data.id = "h1_data";

const div_telefone = document.createElement("div");
div_telefone.id = "div_telefone";

const input_telefone = document.createElement("input");
input_telefone.id = "input_telefone";
input_telefone.type = "number";

const h1_telefone = document.createElement("h1");
h1_telefone.id = "h1_telefone";

const div_email = document.createElement("div");
div_email.id = "div_email";

const input_email = document.createElement("input");
input_email.id = "input_email";
input_email.type = "email";
const h1_email = document.createElement("h1");
h1_email.id = "h1_email";


const div_foto = document.createElement("div");
div_foto.id = "div_foto";

const input_foto = document.createElement("input");
input_foto.id = "input_foto";

const h1_foto = document.createElement("h1");
h1_foto.id = "h1_foto";

const div_senha = document.createElement("div");
div_senha.id = "div_senha";

const input_senha = document.createElement("input");
input_senha.id = "input_senha";
input_senha.type = "password";

const h1_senha = document.createElement("h1");
h1_senha.id = "h1_senha";
h1_senha.textContent = "Senha";


    const primeiraDiv = document.createElement("div");
    primeiraDiv.id = "primeiraDiv";

    const segundaDiv = document.createElement("div");
    segundaDiv.id = "segundaDiv";

    const terceiraDiv = document.createElement("div");
    terceiraDiv.id = "terceiraDiv";

    const quartaDiv = document.createElement("div");
    quartaDiv.id = "quartaDiv";

    const quintaDiv = document.createElement("div");
    quintaDiv.id = "quintaDiv";

    const sextaDiv = document.createElement("div");
    sextaDiv.id = "sextaDiv";

    btn_funcionario.addEventListener("click",async () => {
        const cod_um = await fetch(`http://localhost:3000/empresa/cod/${nomeUser}`);
                const cod_empr = Number(await cod_um.json());
console.log(cod_empr);



    tela.innerHTML = "";
    div_cadastro.innerHTML = "";
    div_header.innerHTML ="";
    tela.appendChild(div_cadastro);
    div_cadastro.appendChild(div_header);
    div_header.appendChild(texto_header);
    texto_header.textContent = "Cadastro funcionário";
    texto_header.appendChild(texto_header_barra);

    div_cadastro.appendChild(primeiraDiv);
    primeiraDiv.appendChild(div_nome);
    primeiraDiv.appendChild(div_cargo);
    div_cargo.appendChild(h1_cargo);
    h1_cargo.textContent = "Cargo";
    div_cargo.appendChild(input_cargo);


    const items = async()=>
    {
    input_cargo.textContent = "";
    const response = await fetch(`http://localhost:3000/cargo/mostrar/${cod_empr}`);
    const res_tratada = await response.json();
    const cargos = res_tratada.data;
    
        cargos.forEach(cargo => {
            const option = document.createElement('option');
            option.value = cargo.Nome; 
            option.textContent = cargo.Nome; 
            input_cargo.appendChild(option);
        });
    }
    items();
    div_nome.appendChild(h1_nome);
    h1_nome.textContent = "Nome";
    div_nome.appendChild(input_nome);

    div_cadastro.appendChild(segundaDiv);
    div_cadastro.appendChild(terceiraDiv);
    div_cadastro.appendChild(quartaDiv);
    div_cadastro.appendChild(quintaDiv);
    div_cadastro.appendChild(sextaDiv);

    segundaDiv.appendChild(div_rg);
    div_rg.appendChild(h1_rg);
    h1_rg.textContent = "RG";
    div_rg.appendChild(input_rg);

    segundaDiv.appendChild(div_cpf);
    div_cpf.appendChild(h1_cpf);
    h1_cpf.textContent = "CPF";
    div_cpf.appendChild(input_cpf);

    terceiraDiv.appendChild(div_telefone);
    div_telefone.appendChild(h1_telefone);
    h1_telefone.textContent = "Telefone";
    div_telefone.appendChild(input_telefone);

    terceiraDiv.appendChild(div_data);
    div_data.appendChild(h1_data);
    h1_data.textContent = "Data de Nascimento";
    div_data.appendChild(input_data);

    quartaDiv.appendChild(div_email);
    div_email.appendChild(h1_email);
    h1_email.textContent = "Email";
    div_email.appendChild(input_email);

    quartaDiv.appendChild(div_senha);
    div_senha.appendChild(h1_senha);
    div_senha.appendChild(input_senha);

    sextaDiv.appendChild(div_foto);
    div_foto.appendChild(h1_foto);
    h1_foto.textContent = "Foto";
    div_foto.appendChild(input_foto);
    input_foto.type = "file";


    const button_exibir = document.createElement("button");
    button_exibir.textContent = "Exibir Dados";
    button_exibir.id = "button_exibir";
    div_cadastro.appendChild(button_exibir);

    const button_cadastrar = document.createElement("button");
    button_cadastrar.textContent = "Cadastrar funcionário";
    button_cadastrar.id = "button_cadastrar";
    div_cadastro.appendChild(button_cadastrar);

    button_exibir.addEventListener("click", () => {
       
        quintaDiv.innerHTML = "";

        
        const nome = input_nome.value;
        const cargo = input_cargo.value;
        const rg = input_rg.value;
        const cpf = input_cpf.value;
        const telefone = input_telefone.value;
        const data = input_data.value;
        const email = input_email.value;

        const h1_dados = document.createElement("h1");
        h1_dados.id = "h1_dados"
        h1_dados.innerHTML = `
    ${nome}<br>
    ${cargo}<br>
    ${rg}<br>
    ${cpf}<br>
    ${telefone}<br>
    ${data}<br>
    ${email}
`;
        

        const file = input_foto.files[0];
        if (file) {
            const img = document.createElement("img");
            img.id = "img_preview";
            

            const reader = new FileReader();
            reader.onload = (e) => {
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);

            quintaDiv.appendChild(img);
            
        } else {
            const noImageText = document.createElement("h1");
            noImageText.textContent = "Nenhuma imagem.";
            quintaDiv.appendChild(noImageText);
        }
        quintaDiv.appendChild(h1_dados);
    });

    button_cadastrar.addEventListener("click", async () => {
    try {
        // Captura os valores dos inputs

        ///funcionario/mostrarCod/:cod/:nome
        const nomeCargo = input_cargo.value;
        const response_cod = await fetch(`http://localhost:3000/funcionario/mostrarCod/${cod_empr}/${nomeCargo}`);
    const res_cod_tratada = await response_cod.json();
    const codCargo = res_cod_tratada.data;
       
        const nome = input_nome.value;
        const email = input_email.value;
        const telefone = input_telefone.value;
        const cpf = input_cpf.value;        
        const senha = input_senha.value;
        const codEmpresa = cod_empr; 

        
        const formData = new FormData();
        formData.append('Nome', nome);
        formData.append('Email', email);
        formData.append('Telefone', telefone);
        formData.append('CPF', cpf);
        formData.append('senha', senha);
        formData.append('Cod_empresa', codEmpresa);
        formData.append('Cod_cargo', codCargo);

        
        if (input_foto.files[0]) {
            formData.append('foto', input_foto.files[0]);
        }

        
        const response = await fetch('http://localhost:3000/funcionario', {
            method: 'POST',
            body: formData,
        });

        
        if (response.ok) {
            const result = await response.text(); 
            alert(result); 
        } else {
            const error = await response.text();
            alert(`Erro: ${error}`);
        }
    } catch (error) {
        console.error('Erro ao cadastrar funcionário:', error);
        alert('Erro ao conectar com o servidor.');
    }
});
});




        const btn_fornecedor = document.getElementById("button_fornecedor");
        const btn_lista = document.createElement("button");
        const tela2 = document.createElement("div");
        const div_mostrar = document.createElement("div");
        div_mostrar.id = "div_mostrar";
        const div_dados = document.createElement("div");
        div_dados.id = "div_dados";
        const img_forn = document.createElement("img");
        img_forn.id = "img_forn";


        btn_fornecedor.addEventListener("click",async ()=>{            
            tela.innerHTML = "";
            div_header.innerHTML ="";
            tela2.innerHTML = "";
            div_dados.innerHTML = "";
            const response = await fetch('http://localhost:3000/fornecedor/mostrar');
            const result = await response.json(); 
            const fornecedores = result.data;          


            btn_lista.id = "btn_lista";
            btn_lista.textContent = "Lista";
            tela2.id = "tela2";
            tela.appendChild(tela2);
            tela2.appendChild(div_header);       
            tela2.appendChild(div_mostrar)     
            div_header.id = "div_header_fornecedores";
            
            div_header.appendChild(texto_header);
            div_header.appendChild(btn_lista)
            texto_header.textContent = "Fornecedores";  
            texto_header.id = 'texto_header_fornecedors';     
            texto_header.appendChild(texto_header_barra);
            texto_header_barra.id = "texto_header_barra_fornecedores";
            const div_demonstracao = document.createElement('div');
            div_demonstracao.id = "div_demonstracao";
            
            const div_nome_imagem_fornecedor = document.createElement("div");
            div_nome_imagem_fornecedor.id = "div_nome_imagem_fornecedor";

            const h1_nome_fornecedor = document.createElement("h1");
            h1_nome_fornecedor.id = "h1_nome_fornecedor";
            const div_img_forn = document.createElement("img");
            div_img_forn.id = "div_img_forn";

            const div_div_imagem_fornecedor = document.createElement("div");
             div_div_imagem_fornecedor.id = "div_div_imagem_fornecedor";  
             
             const div_esquerda = document.createElement("div");
             div_esquerda.id = "div_esquerda";    

             const div_direita = document.createElement("div");
             div_direita.id = "div_direita";    

          
             const div_button_lista = document.createElement("button");
             div_button_lista.id = "div_button_lista";
             div_button_lista.textContent = "Adicionar fornecedor";

             const div_primaria = document.createElement("div");
            div_primaria.id = "div_primaria";


            const div_secundaria = document.createElement("div");
            div_secundaria.id = "div_secundaria";

            const div_terciaria = document.createElement("div");
            div_terciaria.id = "div_terciaria";

            const h1_primaria_cep = document.createElement("h1");
            h1_primaria_cep.id = "h1_primaria_cep";         

            const h1_primaria_estado = document.createElement("h1");
            h1_primaria_estado.id = "h1_primaria_estado";    

            const h1_primaria_cidade = document.createElement("h1");
            h1_primaria_cidade.id = "h1_primaria_cidade";      

            const h1_primaria_bairro = document.createElement("h1");
            h1_primaria_bairro.id = "h1_primaria_bairro";           
    
            const h1_secundaria_nf = document.createElement("h1");
            h1_secundaria_nf.id = "h1_secundaria_nf";

            const h1_secundaria_cnpj = document.createElement("h1");
            h1_secundaria_cnpj.id = "h1_secundaria_cnpj";

            const h1_secundaria_telefone = document.createElement("h1");
            h1_secundaria_telefone.id = "h1_secundaria_telefone";

            const h1_secundaria_email = document.createElement("h1");
            h1_secundaria_email.id = "h1_secundaria_email";

            const div_primaria_cep = document.createElement("div");
            div_primaria_cep.id = "div_primaria_cep";

            const div_primaria_estado = document.createElement("div");
            div_primaria_estado.id = "div_primaria_estado";

            const div_primaria_cidade = document.createElement("div");
            div_primaria_cidade.id = "div_primaria_cidade";

            const div_primaria_bairro = document.createElement("div");
            div_primaria_bairro.id = "div_primaria_bairro";

            const div_secundaria_nf = document.createElement("div");
            div_secundaria_nf.id = "div_secundaria_nf";

            const div_secundaria_cnpj = document.createElement("div");
            div_secundaria_cnpj.id = "div_secundaria_cnpj";

            const div_secundaria_telefone = document.createElement("div");
            div_secundaria_telefone.id = "div_secundaria_telefone";

            const div_secundaria_email = document.createElement("div");
            div_secundaria_email.id = "div_secundaria_email";

            const titulo_primaria_cep = document.createElement("h1");
            titulo_primaria_cep.id = "titulo_primaria_cep";

            const titulo_primaria_estado = document.createElement("h1");
            titulo_primaria_estado.id = "titulo_primaria_estado";

            const titulo_primaria_cidade = document.createElement("h1");
            titulo_primaria_cidade.id = "titulo_primaria_cidade";

            const titulo_primaria_bairro = document.createElement("h1");
            titulo_primaria_bairro.id = "titulo_primaria_bairro";

           
            const titulo_secundaria_nf = document.createElement("h1");
            titulo_secundaria_nf.id = "titulo_secundaria_nf";

            const titulo_secundaria_cnpj = document.createElement("h1");
            titulo_secundaria_cnpj.id = "titulo_secundaria_cnpj";

            const titulo_secundaria_telefone = document.createElement("h1");
            titulo_secundaria_telefone.id = "titulo_secundaria_telefone";

            const titulo_secundaria_email = document.createElement("h1");
            titulo_secundaria_email.id = "titulo_secundaria_email";

            const div_produtos = document.createElement("div");
            div_produtos.id = "div_produtos";

            const div_dados_fornecedor = document.createElement("div");
             div_dados_fornecedor.id = "div_dados_fornecedor";

             const div_fornecedores = document.createElement("div");
             div_fornecedores.id = "div_fornecedores";


             
             fornecedores.forEach(async (user) => { 

  
div_mostrar.appendChild(div_dados); 
  div_dados.appendChild(img_forn);   

  try {
      
      const response = await fetch(`http://localhost:3000/fornecedor/imagem/${user.razao_social}`);
      console.log(response);

      const blob = await response.blob();
      if (response.ok) {
     
          img_forn.src = blob ? URL.createObjectURL(blob) : "../img/imagem_user.png";
          console.log('Imagem carregada com sucesso');
      } else {
        
          img_forn.src = "../img/imagem_user.png";
      }
  } catch (error) {

      img_forn.src = "../img/imagem_user.png";
      console.log("Erro ao carregar a imagem:", error);
  }

  const nomeFornecedor = document.createElement("h1");
  nomeFornecedor.textContent = user.razao_social;
  div_dados.appendChild(nomeFornecedor);

  div_dados.addEventListener('click',async ()=>{
      div_demonstracao.innerHTML = "";
      const response = await fetch(`http://localhost:3000/fornecedor/imagem/${user.razao_social}`);
      const blob = await response.blob();
      tela.appendChild(div_demonstracao);


      div_demonstracao.appendChild(div_esquerda);
      div_esquerda.appendChild(div_div_imagem_fornecedor);
      div_esquerda.appendChild(div_button_lista);    
      div_div_imagem_fornecedor.appendChild(div_nome_imagem_fornecedor);
      div_div_imagem_fornecedor.appendChild(h1_nome_fornecedor);
      h1_nome_fornecedor.textContent = `${user.razao_social}`;
      div_nome_imagem_fornecedor.appendChild(div_img_forn);
      div_img_forn.src = blob ? URL.createObjectURL(blob) : "../img/imagem_user.png";
      div_demonstracao.appendChild(div_direita);


      div_direita.appendChild(div_primaria);
      div_direita.appendChild(div_secundaria);
      div_direita.appendChild(div_terciaria);


          div_primaria.appendChild(div_primaria_cep);
      div_primaria_cep.appendChild(titulo_primaria_cep);
      div_primaria_cep.appendChild(h1_primaria_cep);
      titulo_primaria_cep.textContent = "CEP";
      h1_primaria_cep.textContent = `${user.cep}`

      div_primaria.appendChild(div_primaria_estado);
      div_primaria_estado.appendChild(titulo_primaria_estado);
      div_primaria_estado.appendChild(h1_primaria_estado);
      titulo_primaria_estado.textContent = "Estado";
      h1_primaria_estado.textContent = `${user.estado}`

      div_primaria.appendChild(div_primaria_cidade);
      div_primaria_cidade.appendChild(titulo_primaria_cidade);
      div_primaria_cidade.appendChild(h1_primaria_cidade);
      titulo_primaria_cidade.textContent = "Cidade";
      h1_primaria_cidade.textContent = `${user.cidade}`;

      div_primaria.appendChild(div_primaria_bairro);
      div_primaria_bairro.appendChild(titulo_primaria_bairro);
      div_primaria_bairro.appendChild(h1_primaria_bairro);
      titulo_primaria_bairro.textContent = "Bairro";
      h1_primaria_bairro.textContent = `${user.bairro}`;

      div_secundaria.appendChild(div_secundaria_nf);
      div_secundaria_nf.appendChild(titulo_secundaria_nf);
      div_secundaria_nf.appendChild(h1_secundaria_nf);
      titulo_secundaria_nf.textContent = "NF";
      h1_secundaria_nf.textContent = `${user.nome_fantasia}`;

      div_secundaria.appendChild(div_secundaria_cnpj);
      div_secundaria_cnpj.appendChild(titulo_secundaria_cnpj);
      div_secundaria_cnpj.appendChild(h1_secundaria_cnpj);
      titulo_secundaria_cnpj.textContent = "CNPJ";
      h1_secundaria_cnpj.textContent = `${user.cnpj}`;

      div_secundaria.appendChild(div_secundaria_telefone);
      div_secundaria_telefone.appendChild(titulo_secundaria_telefone);
      div_secundaria_telefone.appendChild(h1_secundaria_telefone);
      titulo_secundaria_telefone.textContent = "Telefone";
      h1_secundaria_telefone.textContent = `${user.telefone}`;

      div_secundaria.appendChild(div_secundaria_email);
      div_secundaria_email.appendChild(titulo_secundaria_email);
      div_secundaria_email.appendChild(h1_secundaria_email);
      titulo_secundaria_email.textContent = "Email";
      h1_secundaria_email.textContent = `${user.email}`;

          const cod_um = await fetch(`http://localhost:3000/fornecedor/cod/${user.razao_social}`);
      const cod_empr = await cod_um.json();
      
      if (!cod_empr) {
          console.error('Código do fornecedor não encontrado.');
          return { produtos: [], quantidade: [] }; // Retorna arrays vazios em caso de erro
      }

      // Codificar o valor (caso necessário)

      // Buscar os valores dos produtos com base no código do fornecedor
      const responsea = await fetch(`http://localhost:3000/fornecedor/mostrar_valores/${cod_empr}`);
      
      if (!responsea.ok) {
          console.error('Erro na resposta da rede ao buscar produtos.');
          return { produtos: [], quantidade: [] }; // Retorna arrays vazios em caso de erro
      }
      
      const resposta = await responsea.json();
      const produtos = resposta.data;
      
      // Log para verificar os dados recebidos
      console.log('Dados recebidos do backend (produtos):', produtos);
      console.log('Tipo de dados retornado:', Array.isArray(produtos) ? 'Array' : typeof produtos);
      console.log('Primeiro item do array:', produtos[0]);

      // Buscar a quantidade de produtos com base no código do fornecedor
      const responseQuant = await fetch(`http://localhost:3000/fornecedor/mostrar_quantidade/${cod_empr}`);
      
      if (!responseQuant.ok) {
          console.error('Erro na resposta da rede ao buscar quantidade.');
          return { produtos: [], quantidade: [] }; // Retorna arrays vazios em caso de erro
      }
      
      const respostaQuant = await responseQuant.json();
      const quantidade = respostaQuant.data;
      
      // Log para verificar os dados de quantidade
      console.log('Dados recebidos do backend (quantidade):', quantidade);
      console.log('Tipo de dados retornado:', Array.isArray(quantidade) ? 'Array' : typeof quantidade);
      console.log('Primeiro item do array:', quantidade[0]);

      div_terciaria.appendChild(div_produtos);
      div_produtos.textContent = `Nome: ${produtos.Nome}_______________________________________________________________Valor: ${produtos.valor}`;

      div_terciaria.appendChild(div_produtos);
      div_produtos.textContent = `Nome: ${quantidade.Nome}_______________________________________________________________Valor: ${quantidade.valor}`;


 btn_lista.addEventListener("click",async ()=>{
      tela.innerHTML = "";
      tela.appendChild(div_fornecedores);
       const cod_dois = await fetch(`http://localhost:3000/empresa/cod/${nomeUser}`);
       const cod_tres = await cod_dois.json();
     
       const response = await fetch(`http://localhost:3000/fornecedor_lista/mostrar/${cod_tres}`);
       const res = await response.json();
       const resultado = res.data;



      resultado.forEach(async (user)=>{
          console.log(user.fornecedor_cod);
       const responsa = await fetch(`http://localhost:3000/fornecedor/nome/${user.fornecedor_cod}`);
      // console.log(await responsa.json());
      const dados = await responsa.json()
      div_fornecedores.appendChild(div_dados_fornecedor);
       div_dados_fornecedor.textContent = `${dados}`;
      });

       //fornecedor_cod

      alert("funciona");
        
     
  })

      div_button_lista.addEventListener("click",async ()=>{
          const cod_dois = await fetch(`http://localhost:3000/empresa/cod/${nomeUser}`);
          const cod_tres = await cod_dois.json();
          try{
              
          const response = await fetch(`http://localhost:3000/fornecedor_lista/${cod_empr}/${cod_tres}`, {
                      method: 'POST'           
      });

      alert("Fornecedor salvo")

      }

      catch(error){
          alert("Erro");
          console.log(error);
          }


  });



});
});


});
}//fim cadastros

cadastros();
});//fim dom
</script>
</body>
</html>
